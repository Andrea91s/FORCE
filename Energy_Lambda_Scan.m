% PASSING = Passing and encirling = 1 green
% STAGNATING = Passing and not encircling = 2 blue
% TRAPPED  = Trapped and not encircling= 3 orange
% LOST = 4 red
% POTATO = Trapped and encircling = 5 yellow
close all;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%2ND_PRE_SAWTOOTH
%R=1.2
%{ 
w = [1 1 1 1 1 1 1 3 3 2 2 3 3 3 3 3 3 4 4 4 1;...
     1 1 1 1 1 1 5 3 3 2 2 3 3 3 3 3 3 3 4 1 1;...
     1 1 1 1 1 1 3 3 3 3 2 3 3 3 3 3 3 3 4 1 1;... 
     1 1 1 1 1 5 3 3 3 3 2 3 3 3 3 3 3 3 3 1 1;... 
     1 1 1 1 1 5 3 3 3 3 2 3 3 3 3 3 3 3 1 1 1; ...
     1 1 1 1 1 3 3 3 3 3 2 3 3 3 3 3 3 3 1 1 1];
   
%2ND_PRE_SAWTOOTH
%R=1.1
w = [1 1 1 1 1 1 1 2 2 2 2 3 3 3 3 3 3 3 1 1 1;...
     1 1 1 1 1 1 1 2 2 2 2 3 3 3 3 3 3 3 1 1 1;...
     1 1 1 1 1 1 1 2 2 2 2 3 3 3 3 3 3 3 1 1 1;... 
     1 1 1 1 1 1 1 2 2 2 2 3 3 3 3 3 3 3 1 1 1;...
     1 1 1 1 1 1 1 2 2 2 2 3 3 3 3 3 3 1 1 1 1;...
     1 1 1 1 1 1 1 3 3 2 2 3 3 3 3 3 3 1 1 1 1];
 
 %2ND_PRE_SAWTOOTH
%R=1.0
w = [2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 1 1 1;...
     2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 1 1 1 1;...
     2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 1 1 1 1;... 
     2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 1 1 1 1;... 
     2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 1 1 1 1 1;...
     1 1 1 1 1 1 2 2 2 2 2 3 3 3 3 3 1 1 1 1 1];  
   
 %2ND_PRE_SAWTOOTH
%R=0.9
w = [1 1 1 1 1 1 1 1 1 1 1 5 5 5 5 5 5 2 2 2 2;...
     1 1 1 1 1 1 1 1 1 1 1 5 5 5 5 5 2 2 2 2 2;...
     1 1 1 1 1 1 1 1 1 1 1 5 5 5 5 5 2 2 2 2 2;...
     1 1 1 1 1 1 1 1 1 1 1 5 5 5 5 2 2 2 2 2 2;...
     1 1 1 1 1 1 1 1 1 1 1 5 5 5 5 2 2 2 2 2 2;...
     1 1 1 1 1 1 1 1 1 1 1 5 5 5 2 2 2 2 2 2 2];     
 %}
 %R=0.9 with gyrophase =180

w = [1 5 5 5 3 3 3 1 1 1 2 ;... 60
     1 5 5 5 3 3 1 1 1 1 2 ;... 55
     1 5 5 5 3 3 1 1 1 1 2 ;... 50
     1 5 5 5 3 3 1 1 1 1 2 ;... 45
     1 5 5 5 3 3 1 1 1 2 2 ;... 40
     1 5 5 5 3 3 1 1 1 2 2 ;... 35
     1 5 5 5 3 3 1 1 1 2 2 ;... 30
     1 5 5 5 3 1 1 1 1 2 2 ;... 25
     1 5 5 5 3 1 1 1 1 2 2 ;... 20
     1 5 5 5 3 1 1 1 1 2 2 ;... 15
     1 5 5 5 1 1 1 1 2 2 2 ;... 10
     1 5 5 5 1 1 1 1 2 2 2];    5

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%{
%2ND_POST_SAWTOOTH
%R=1.2
w = [1 1 1 1 1 1 1 3 3 2 2 3 3 3 3 3 3 4 4 4 1;...
     1 1 1 1 1 1 5 3 3 2 2 3 3 3 3 3 3 3 4 1 1;...
     1 1 1 1 1 1 5 3 3 2 2 3 3 3 3 3 3 3 4 1 1;...
     1 1 1 1 1 1 3 3 3 3 2 3 3 3 3 3 3 3 3 1 1;...
     1 1 1 1 1 5 3 3 3 3 2 3 3 3 3 3 3 3 1 1 1;...
     1 1 1 1 1 3 3 3 3 3 2 3 3 3 3 3 3 3 1 1 1];
      
%2ND_POST_SAWTOOTH
%R=1.1
w = [1 1 1 1 1 1 2 2 2 2 2 3 3 3 3 3 3 3 1 1 1;...
     1 1 1 1 1 1 1 2 2 2 2 3 3 3 3 3 3 3 1 1 1;...
     1 1 1 1 1 1 1 2 2 2 2 3 3 3 3 3 3 3 1 1 1;...
     1 1 1 1 1 1 1 2 2 2 2 3 3 3 3 3 3 3 1 1 1;...
     1 1 1 1 1 1 1 2 2 2 2 3 3 3 3 3 3 1 1 1 1;...
     1 1 1 1 1 1 1 3 3 2 2 3 3 3 3 3 3 1 1 1 1];
 
    
 %2ND_POST_SAWTOOTH
%R=1.0
w = [2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 1 1 1 1;...
     2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 1 1 1 1;...
     2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 1 1 1 1;...
     2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 1 1 1 1;...
     2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 1 1 1 1 1;...    
     1 1 1 1 1 1 2 2 2 2 2 3 3 3 3 3 1 1 1 1 1];  
     
 %2ND_POST_SAWTOOTH
%R=0.9
w = [1 1 1 1 1 1 1 1 1 1 1 5 5 5 5 5 5 2 2 2 2;...
     1 1 1 1 1 1 1 1 1 1 1 5 5 5 5 5 2 2 2 2 2;...
     1 1 1 1 1 1 1 1 1 1 1 5 5 5 5 5 2 2 2 2 2;...
     1 1 1 1 1 1 1 1 1 1 1 5 5 5 5 2 2 2 2 2 2;...
     1 1 1 1 1 1 1 1 1 1 1 5 5 5 5 2 2 2 2 2 2;...
     1 1 1 1 1 1 1 1 1 1 1 5 5 5 2 2 2 2 2 2 2];     
%}
 
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%}%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
 
%3RD_PRE_SAWTOOTH
%{
%R=1.2
w = [1 1 1 1 1 1 5 3 3 2 2 3 3 3 3 3 3 4 4 4 1;...
     1 1 1 1 1 1 5 3 3 2 2 3 3 3 3 3 3 4 4 1 1;...
     1 1 1 1 1 1 3 3 3 2 2 3 3 3 3 3 3 3 4 1 1;...
     1 1 1 1 1 5 3 3 3 3 2 3 3 3 3 3 3 3 3 1 1;...
     1 1 1 1 1 3 3 3 3 3 2 3 3 3 3 3 3 3 1 1 1;...
     1 1 1 1 1 3 3 3 3 3 2 3 3 3 3 3 3 3 1 1 1];
     
%3RD_PRE_SAWTOOTH     
%R=1.1
w = [1 1 1 1 1 1 2 2 2 2 2 3 3 3 3 3 3 3 1 1 1;...
     1 1 1 1 1 1 1 2 2 2 2 3 3 3 3 3 3 3 1 1 1;...
     1 1 1 1 1 1 1 2 2 2 2 3 3 3 3 3 3 3 1 1 1;...
     1 1 1 1 1 1 1 2 2 2 2 3 3 3 3 3 3 3 1 1 1;...
     1 1 1 1 1 1 1 2 3 2 2 3 3 3 3 3 3 3 1 1 1;...
     1 1 1 1 1 1 5 3 3 2 2 3 3 3 3 3 3 1 1 1 1];
     

%3RD_PRE_SAWTOOTH
%R=1.0
w = [2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 1 1 1;...
     2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 1 1 1 1;...
     2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 1 1 1 1;...
     2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 1 1 1 1;...
     1 1 1 1 2 2 2 2 2 2 2 3 3 3 3 3 1 1 1 1 1;...
     1 1 1 1 1 1 1 2 2 2 2 3 3 3 3 3 1 1 1 1 1]; 
     
%3RD_PRE_SAWTOOTH
%R=0.9
w = [1 1 1 1 1 1 1 1 1 1 1 5 5 5 5 5 3 2 2 1 1;...
     1 1 1 1 1 1 1 1 1 1 1 5 5 5 5 5 2 2 2 2 2;...
     1 1 1 1 1 1 1 1 1 1 1 5 5 5 5 5 2 2 2 2 2;...
     1 1 1 1 1 1 1 1 1 1 1 5 5 5 5 5 2 2 2 2 2;...
     1 1 1 1 1 1 1 1 1 1 1 5 5 5 5 2 2 2 2 2 2;...
     1 1 1 1 1 1 1 1 1 1 1 5 5 5 2 2 2 2 2 2 2];     
%}  

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


 
%3RD_POST_SAWTOOTH
%{
%R=1.2
w = [1 1 1 1 1 1 1 3 3 2 2 3 3 3 3 3 3 4 4 4 1;...
     1 1 1 1 1 1 5 3 3 2 2 3 3 3 3 3 3 3 4 1 1;...
     1 1 1 1 1 1 3 3 3 2 2 3 3 3 3 3 3 3 4 1 1;...
     1 1 1 1 1 5 3 3 3 3 2 3 3 3 3 3 3 3 3 1 1;...
     1 1 1 1 1 5 3 3 3 3 2 3 3 3 3 3 3 3 1 1 1;...
     1 1 1 1 1 3 3 3 3 3 2 3 3 3 3 3 3 3 1 1 1];
    
%3RD_POST_SAWTOOTH
%R=1.1
w = [1 1 1 1 1 1 1 2 2 2 2 3 3 3 3 3 3 3 4 1 1;...
     1 1 1 1 1 1 1 2 2 2 2 3 3 3 3 3 3 3 1 1 1;...
     1 1 1 1 1 1 1 2 2 2 2 3 3 3 3 3 3 3 1 1 1;...
     1 1 1 1 1 1 1 2 2 2 2 3 3 3 3 3 3 3 1 1 1;...
     1 1 1 1 1 1 1 2 3 2 2 3 3 3 3 3 3 3 1 1 1;...
     1 1 1 1 1 1 5 3 3 2 2 3 3 3 3 3 3 1 1 1 1];
   
 %3RD_POST_SAWTOOTH
%R=1.0
w = [2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 1 1 1;...
     2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 1 1 1 1;...
     2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 1 1 1 1;...
     2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 1 1 1 1;...
     1 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 1 1 1 1;...
     1 1 1 1 1 1 2 2 2 2 2 3 3 3 3 3 1 1 1 1 1];
       
 %3RD_POST_SAWTOOTH
%R=0.9
w = [1 1 1 1 1 1 1 1 1 1 1 5 5 5 5 5 3 1 1 2 2;...
     1 1 1 1 1 1 1 1 1 1 1 5 5 5 5 5 2 2 2 2 2;...
     1 1 1 1 1 1 1 1 1 1 1 5 5 5 5 5 2 2 2 2 2;...
     1 1 1 1 1 1 1 1 1 1 1 5 5 5 5 5 2 2 2 2 2;...
     1 1 1 1 1 1 1 1 1 1 1 5 5 5 5 2 2 2 2 2 2;...
     1 1 1 1 1 1 1 1 1 1 1 5 5 5 2 2 2 2 2 2 2];    
%}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Energy = linspace(60, 5, 12);
lambda = linspace(0,1,11);

mycmap = [0.0 0.5 0.0; 0 59/255 1; 1 149/255 0; 1 0 0; 1 1 0];
%mycmap = [0.0 0.5 0.0; 1 0 0; 0 59/255 1; 1 1 0;1 149/255 0];
imagesc([0 1], [60 5], w)
set(gca, 'YDir', 'normal', 'fontsize', 12)
set(gca, 'xtick', linspace(0,1,11), 'fontsize', 12) 
xlabel('Pitch Angle \lambda')
ylabel('Energy (keV)')
title('EFIT Orbit topology map for 29880 at 0258 s, pre 2nd sawtooth, R = 0.90 m, Z = 0.0 m')
colormap(mycmap);
